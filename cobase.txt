Project file structure:
=======================
```
tailscaled-socks5-android
├── app
│   ├── src
│   │   ├── androidTest
│   │   │   └── java
│   │   │       └── io
│   │   │           └── github
│   │   │               └── asutorufa
│   │   │                   └── tailscaled
│   │   │                       └── ExampleInstrumentedTest.kt
│   │   └── main
│   │       ├── java
│   │       │   └── io
│   │       │       └── github
│   │       │           └── asutorufa
│   │       │               └── tailscaled
│   │       │                   ├── FirstFragment.kt
│   │       │                   ├── MainActivity.kt
│   │       │                   └── TailscaledService.kt
│   │       ├── jniLibs
│   │       │   └── build.sh
│   │       ├── res
│   │       │   ├── drawable
│   │       │   │   ├── ic_launcher_background.xml
│   │       │   │   └── ic_launcher_foreground.xml
│   │       │   ├── layout
│   │       │   │   ├── activity_main.xml
│   │       │   │   ├── content_main.xml
│   │       │   │   └── fragment_first.xml
│   │       │   ├── mipmap-anydpi-v26
│   │       │   │   ├── ic_launcher.xml
│   │       │   │   └── ic_launcher_round.xml
│   │       │   ├── mipmap-hdpi
│   │       │   │   ├── ic_launcher.webp
│   │       │   │   └── ic_launcher_round.webp
│   │       │   ├── mipmap-mdpi
│   │       │   │   ├── ic_launcher.webp
│   │       │   │   └── ic_launcher_round.webp
│   │       │   ├── mipmap-xhdpi
│   │       │   │   ├── ic_launcher.webp
│   │       │   │   └── ic_launcher_round.webp
│   │       │   ├── mipmap-xxhdpi
│   │       │   │   ├── ic_launcher.webp
│   │       │   │   └── ic_launcher_round.webp
│   │       │   ├── mipmap-xxxhdpi
│   │       │   │   ├── ic_launcher.webp
│   │       │   │   └── ic_launcher_round.webp
│   │       │   ├── navigation
│   │       │   │   └── nav_graph.xml
│   │       │   ├── values
│   │       │   │   ├── colors.xml
│   │       │   │   ├── dimens.xml
│   │       │   │   ├── strings.xml
│   │       │   │   └── themes.xml
│   │       │   ├── values-land
│   │       │   │   └── dimens.xml
│   │       │   ├── values-night
│   │       │   │   └── themes.xml
│   │       │   ├── values-v23
│   │       │   │   └── themes.xml
│   │       │   ├── values-w1240dp
│   │       │   │   └── dimens.xml
│   │       │   ├── values-w600dp
│   │       │   │   └── dimens.xml
│   │       │   └── xml
│   │       │       ├── backup_rules.xml
│   │       │       └── data_extraction_rules.xml
│   │       └── AndroidManifest.xml
│   ├── .gitignore
│   ├── build.gradle.kts
│   └── proguard-rules.pro
├── appctr
│   ├── appctr.go
│   ├── appctr_test.go
│   ├── build.gradle
│   ├── build.sh
│   ├── go.mod
│   └── go.sum
├── gradle
│   ├── wrapper
│   │   ├── gradle-wrapper.jar
│   │   └── gradle-wrapper.properties
│   └── libs.versions.toml
├── .gitignore
├── build.gradle.kts
├── build.sh
├── gradle.properties
├── gradlew
├── gradlew.bat
├── readme.md
├── settings.gradle.kts
└── version
```

File contents:
==============
--- START OF FILE: app\src\androidTest\java\io\github\asutorufa\tailscaled\ExampleInstrumentedTest.kt ---
```kt
package io.github.asutorufa.tailscaled

import androidx.test.platform.app.InstrumentationRegistry
import androidx.test.ext.junit.runners.AndroidJUnit4

import org.junit.Test
import org.junit.runner.RunWith

import org.junit.Assert.*

/**
 * Instrumented test, which will execute on an Android device.
 *
 * See [testing documentation](http://d.android.com/tools/testing).
 */
@RunWith(AndroidJUnit4::class)
class ExampleInstrumentedTest {
    @Test
    fun useAppContext() {
        // Context of the app under test.
        val appContext = InstrumentationRegistry.getInstrumentation().targetContext
        assertEquals("io.github.asutorufa.libtailscaled.so", appContext.packageName)
    }
}
```
--- END OF FILE: app\src\androidTest\java\io\github\asutorufa\tailscaled\ExampleInstrumentedTest.kt ---

--- START OF FILE: app\src\main\AndroidManifest.xml ---
```xml
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools">

    <uses-permission android:name="android.permission.INTERNET" />
    <uses-permission android:name="android.permission.FOREGROUND_SERVICE" />
    <uses-permission android:name="android.permission.FOREGROUND_SERVICE_SPECIAL_USE" />
    <uses-permission android:name="android.permission.CHANGE_NETWORK_STATE" />
    <uses-permission android:name="android.permission.ACCESS_NETWORK_STATE" />
    <uses-permission android:name="android.permission.POST_NOTIFICATIONS" />

    <application
        android:allowBackup="true"
        android:dataExtractionRules="@xml/data_extraction_rules"
        android:fullBackupContent="@xml/backup_rules"
        android:icon="@mipmap/ic_launcher"
        android:label="@string/app_name"
        android:roundIcon="@mipmap/ic_launcher_round"
        android:supportsRtl="true"
        android:theme="@style/Theme.Tailscaled"
        tools:targetApi="31">
        <service
            android:name=".TailscaledService"
            android:directBootAware="true"
            android:foregroundServiceType="specialUse"
            android:exported="false">
            <property android:name="android.app.PROPERTY_SPECIAL_USE_FGS_SUBTYPE" android:value="tailscaled service"/>
        </service>

        <activity
            android:name=".MainActivity"
            android:exported="true"
            android:launchMode="singleTask"
            android:theme="@style/Theme.Tailscaled">
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />
                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
    </application>

</manifest>
```
--- END OF FILE: app\src\main\AndroidManifest.xml ---

--- START OF FILE: app\src\main\java\io\github\asutorufa\tailscaled\FirstFragment.kt ---
```kt
package io.github.asutorufa.tailscaled

import android.content.BroadcastReceiver
import android.content.ComponentName
import android.content.Context
import android.content.Intent
import android.content.IntentFilter
import android.content.ServiceConnection
import android.content.SharedPreferences
import android.os.Build
import android.os.Bundle
import android.os.IBinder
import android.os.Message
import android.os.Messenger
import android.util.Log
import android.view.LayoutInflater
import android.view.View
import android.view.ViewGroup
import android.widget.TextView
import androidx.core.widget.doAfterTextChanged
import androidx.fragment.app.Fragment
import io.github.asutorufa.tailscaled.databinding.FragmentFirstBinding


/**
 * A simple [Fragment] subclass as the default destination in the navigation.
 */
class FirstFragment : Fragment() {
    private lateinit var binding: FragmentFirstBinding

    private lateinit var sharedPreferences: SharedPreferences

    private var isRunning = false
    private val bReceiver: BroadcastReceiver = object : BroadcastReceiver() {
        override fun onReceive(context: Context, intent: Intent) {
            Log.d(tag, "onReceive: ${intent.action}")

            when (intent.action) {
                "START" -> {
                    binding.buttonFirst.text = "Stop"
                    isRunning = true
                    binding.socks5.isEnabled = false
                    binding.sshserver.isEnabled = false
                    binding.authkey.isEnabled = false
                }

                "STOP" -> {
                    binding.buttonFirst.text = "Start"
                    isRunning = false
                    binding.socks5.isEnabled = true
                    binding.sshserver.isEnabled = true
                    binding.authkey.isEnabled = true
                }
            }
        }
    }

    /** Messenger for communicating with the service.  */
    private var mService: Messenger? = null

    /** Flag indicating whether we have called bind on the service.  */
    private var bound: Boolean = false

    /**
     * Class for interacting with the main interface of the service.
     */
    private val mConnection = object : ServiceConnection {

        override fun onServiceConnected(className: ComponentName, service: IBinder) {
            // This is called when the connection with the service has been
            // established, giving us the object we can use to
            // interact with the service.  We are communicating with the
            // service using a Messenger, so here we get a client-side
            // representation of that from the raw IBinder object.
            mService = Messenger(service)
            bound = true
            mService?.send(
                Message.obtain(
                    null,
                    TailscaledService.MSG_SAY_HELLO,
                    0,
                    0
                )
            )
        }

        override fun onServiceDisconnected(className: ComponentName) {
            // This is called when the connection with the service has been
            // unexpectedly disconnected -- that is, its process crashed.
            mService = null
            bound = false
        }
    }

    override fun onCreateView(
        inflater: LayoutInflater, container: ViewGroup?,
        savedInstanceState: Bundle?
    ): View {
        binding = FragmentFirstBinding.inflate(inflater, container, false)

        return binding.root
    }

    override fun onSaveInstanceState(outState: Bundle) {
        super.onSaveInstanceState(outState)
    }

    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
        sharedPreferences = requireActivity().getSharedPreferences("appctr", Context.MODE_PRIVATE)
    }

    override fun onResume() {
        super.onResume()

        binding.socks5.setText(
            sharedPreferences.getString("socks5", "0.0.0.0:1055"),
            TextView.BufferType.EDITABLE,
        )
        binding.sshserver.setText(
            sharedPreferences.getString("sshserver", "0.0.0.0:1056"),
            TextView.BufferType.EDITABLE,
        )
        binding.authkey.setText(
            sharedPreferences.getString("authkey", ""),
            TextView.BufferType.EDITABLE,
        )
    }

    override fun onViewCreated(view: View, savedInstanceState: Bundle?) {
        super.onViewCreated(view, savedInstanceState)

        val intentFilter = IntentFilter().apply {
            addAction("START")
            addAction("STOP")
        }
        if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.TIRAMISU)
            activity?.registerReceiver(bReceiver, intentFilter, Context.RECEIVER_EXPORTED)
        else activity?.registerReceiver(bReceiver, intentFilter)

        // Bind to the service
        Intent(activity, TailscaledService::class.java).also { intent ->
            activity?.bindService(intent, mConnection, Context.BIND_AUTO_CREATE)
        }



        binding.socks5.doAfterTextChanged { text ->
            sharedPreferences.edit().apply {
                putString("socks5", text.toString())
                commit()
            }
        }

        binding.sshserver.doAfterTextChanged { text ->
            sharedPreferences.edit().apply {
                putString("sshserver", text.toString())
                commit()
            }
        }

        binding.authkey.doAfterTextChanged { text ->
            sharedPreferences.edit().apply {
                putString("authkey", text.toString())
                commit()
            }

        }

        binding.buttonFirst.setOnClickListener {
            Log.d("activity", "is running: $isRunning")
            if (isRunning) mService?.send(
                Message.obtain(
                    null,
                    TailscaledService.MSG_STOP,
                    0,
                    0
                )
            )
            else
                activity?.startService(
                    Intent(
                        activity,
                        TailscaledService::class.java
                    )
                )
        }
    }
}
```
--- END OF FILE: app\src\main\java\io\github\asutorufa\tailscaled\FirstFragment.kt ---

--- START OF FILE: app\src\main\java\io\github\asutorufa\tailscaled\MainActivity.kt ---
```kt
package io.github.asutorufa.tailscaled

import android.os.Bundle
import androidx.appcompat.app.AppCompatActivity
import androidx.navigation.findNavController
import androidx.navigation.ui.AppBarConfiguration
import androidx.navigation.ui.navigateUp
import androidx.navigation.ui.setupActionBarWithNavController
import io.github.asutorufa.tailscaled.databinding.ActivityMainBinding

class MainActivity : AppCompatActivity() {



    private lateinit var appBarConfiguration: AppBarConfiguration
    private lateinit var binding: ActivityMainBinding

    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)

        binding = ActivityMainBinding.inflate(layoutInflater)
        setContentView(binding.root)

        setSupportActionBar(binding.toolbar)

        val navController = findNavController(R.id.nav_host_fragment_content_main)
        appBarConfiguration = AppBarConfiguration(navController.graph)
        setupActionBarWithNavController(navController, appBarConfiguration)
    }

    override fun onSupportNavigateUp(): Boolean {
        val navController = findNavController(R.id.nav_host_fragment_content_main)
        return navController.navigateUp(appBarConfiguration)
                || super.onSupportNavigateUp()
    }
}
```
--- END OF FILE: app\src\main\java\io\github\asutorufa\tailscaled\MainActivity.kt ---

--- START OF FILE: app\src\main\java\io\github\asutorufa\tailscaled\TailscaledService.kt ---
```kt
package io.github.asutorufa.tailscaled

import android.app.NotificationChannel
import android.app.NotificationManager
import android.app.PendingIntent
import android.app.Service
import android.content.Context
import android.content.Intent
import android.content.SharedPreferences
import android.os.Build
import android.os.Handler
import android.os.IBinder
import android.os.Looper
import android.os.Message
import android.os.Messenger
import android.util.Log
import androidx.core.app.NotificationCompat
import androidx.core.content.getSystemService
import appctr.Appctr
import appctr.Closer
import appctr.StartOptions


class TailscaledService : Service() {
    private val notification by lazy { application.getSystemService<NotificationManager>()!! }
    private lateinit var sharedPreferences: SharedPreferences

    override fun onCreate() {
        super.onCreate()
        mMessenger = Messenger(IncomingHandler(this))
        sharedPreferences = getSharedPreferences("appctr", Context.MODE_PRIVATE)
    }

    private fun startNotification() {
        // Notifications on Oreo and above need a channel
        if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.O)
            notification.createNotificationChannel(
                NotificationChannel(
                    packageName,
                    "Tailscaled",
                    NotificationManager.IMPORTANCE_MIN
                )
            )

        startForeground(
            1,
            NotificationCompat.Builder(this, packageName)
                .setContentTitle("Tailscaled は実行中です")
                .setSmallIcon(R.drawable.ic_launcher_foreground)
                .setContentIntent(
                    PendingIntent.getActivity(
                        this,
                        0,
                        Intent(this, MainActivity::class.java),
                        PendingIntent.FLAG_UPDATE_CURRENT or PendingIntent.FLAG_IMMUTABLE
                    )
                )
                .build()
        )
    }

    override fun onStartCommand(intent: Intent?, flags: Int, startId: Int): Int {
        Log.d(TAG, "starting")
        if (Appctr.isRunning()) return START_STICKY
        start()
        startNotification()
        applicationContext.sendBroadcast(Intent("START"))
        return START_STICKY
    }

    override fun onBind(p0: Intent?): IBinder? {
        return mMessenger.binder
    }

    override fun onDestroy() {
        super.onDestroy()
        Log.d(TAG, "try to stopMe")
        stopMe()
    }

    private fun stopMe() {
        Log.d(TAG, "try to stopMe")
        stopForeground(STOP_FOREGROUND_REMOVE)
        Appctr.stop()
        stopSelf()
        applicationContext.sendBroadcast(Intent("STOP"))
    }

    /**
     * Target we publish for clients to send messages to IncomingHandler.
     */
    private lateinit var mMessenger: Messenger

    /**
     * Handler of incoming messages from clients.
     */
    private class IncomingHandler(
        var context: TailscaledService,
        private val applicationContext: Context = context.applicationContext
    ) : Handler(Looper.getMainLooper()) {
        override fun handleMessage(msg: Message) {
            Log.d(TAG, "receive message: ${msg.what}")
            when (msg.what) {
                MSG_SAY_HELLO -> {
                    applicationContext.sendBroadcast(Intent(if (Appctr.isRunning()) "START" else "STOP"))
                }

                MSG_STOP -> {
                    context.stopMe()
                }

                MSG_START -> context.onStartCommand(null, 0, 0)

                else -> super.handleMessage(msg)
            }
        }
    }

    private fun start() = Appctr.start(StartOptions().apply {
        socks5Server = sharedPreferences.getString("socks5", "0.0.0.0:1055")
        sshServer = sharedPreferences.getString("sshserver", "0.0.0.0:1056")
        authKey = sharedPreferences.getString("authkey", "")
        execPath = "${applicationInfo.nativeLibraryDir}/libtailscaled.so"
        socketPath = "${applicationInfo.dataDir}/tailscaled.sock"
        statePath = "${applicationInfo.dataDir}/state"
        closeCallBack = Closer { stopMe() }
    })


    companion object {
        private val TAG = TailscaledService::class.java.simpleName
        const val MSG_SAY_HELLO = 0
        const val MSG_STOP = 1
        const val MSG_START = 2
    }
}
```
--- END OF FILE: app\src\main\java\io\github\asutorufa\tailscaled\TailscaledService.kt ---

--- START OF FILE: app\src\main\jniLibs\build.sh ---
```sh
set -x
current=$(dirname "$(readlink -f "$0")")
CORE_HOME=${CORE_HOME:-${HOME}/Documents/Programming/tailscale}
cd $CORE_HOME
if [ "${ANDROID_NDK_HOME}" = "" ]; then
	export ANDROID_NDK_HOME="/opt/android-ndk"
fi

export GOOS=android
export CGO_ENABLED=1
## see: https://tailscale.com/kb/1207/small-tailscale
BUILD_TAGS="ts_include_cli,ts_omit_aws,ts_omit_bird,ts_omit_tap,ts_omit_kube,ts_omit_completion,ts_omit_systray,ts_omit_taildrop,ts_omit_tap,ts_omit_tpm,ts_omit_syspolicy,ts_omit_kube,ts_omit_desktop_sessions"
CC=${ANDROID_NDK_HOME}/toolchains/llvm/prebuilt/linux-x86_64/bin/aarch64-linux-android21-clang GOARCH=arm64 go build -ldflags='-s -w -checklinkname=0 -buildid=' -tags ${BUILD_TAGS} -trimpath -o ${current}/arm64-v8a/libtailscaled.so -v ./cmd/tailscaled/.
CC=${ANDROID_NDK_HOME}/toolchains/llvm/prebuilt/linux-x86_64/bin/x86_64-linux-android21-clang GOARCH=amd64 go build -ldflags='-s -w -checklinkname=0 -buildid=' -tags ${BUILD_TAGS} -trimpath -o ${current}/x86_64/libtailscaled.so -v ./cmd/tailscaled/.

# CC=${ANDROID_NDK_HOME}/toolchains/llvm/prebuilt/linux-x86_64/bin/aarch64-linux-android21-clang GOARCH=arm64 go build -ldflags='-s -w -buildid=' -trimpath -o ${current}/arm64-v8a/libtailscale.so -v ./cmd/tailscale/.
# CC=${ANDROID_NDK_HOME}/toolchains/llvm/prebuilt/linux-x86_64/bin/x86_64-linux-android21-clang GOARCH=amd64 go build -ldflags='-s -w -buildid=' -trimpath -o ${current}/x86_64/libtailscale.so -v ./cmd/tailscale/.
```
--- END OF FILE: app\src\main\jniLibs\build.sh ---

--- START OF FILE: app\src\main\res\drawable\ic_launcher_background.xml ---
```xml
<?xml version="1.0" encoding="utf-8"?>
<vector xmlns:android="http://schemas.android.com/apk/res/android"
    android:width="108dp"
    android:height="108dp"
    android:viewportWidth="108"
    android:viewportHeight="108">
    <path
        android:fillColor="#3DDC84"
        android:pathData="M0,0h108v108h-108z" />
    <path
        android:fillColor="#00000000"
        android:pathData="M9,0L9,108"
        android:strokeWidth="0.8"
        android:strokeColor="#33FFFFFF" />
    <path
        android:fillColor="#00000000"
        android:pathData="M19,0L19,108"
        android:strokeWidth="0.8"
        android:strokeColor="#33FFFFFF" />
    <path
        android:fillColor="#00000000"
        android:pathData="M29,0L29,108"
        android:strokeWidth="0.8"
        android:strokeColor="#33FFFFFF" />
    <path
        android:fillColor="#00000000"
        android:pathData="M39,0L39,108"
        android:strokeWidth="0.8"
        android:strokeColor="#33FFFFFF" />
    <path
        android:fillColor="#00000000"
        android:pathData="M49,0L49,108"
        android:strokeWidth="0.8"
        android:strokeColor="#33FFFFFF" />
    <path
        android:fillColor="#00000000"
        android:pathData="M59,0L59,108"
        android:strokeWidth="0.8"
        android:strokeColor="#33FFFFFF" />
    <path
        android:fillColor="#00000000"
        android:pathData="M69,0L69,108"
        android:strokeWidth="0.8"
        android:strokeColor="#33FFFFFF" />
    <path
        android:fillColor="#00000000"
        android:pathData="M79,0L79,108"
        android:strokeWidth="0.8"
        android:strokeColor="#33FFFFFF" />
    <path
        android:fillColor="#00000000"
        android:pathData="M89,0L89,108"
        android:strokeWidth="0.8"
        android:strokeColor="#33FFFFFF" />
    <path
        android:fillColor="#00000000"
        android:pathData="M99,0L99,108"
        android:strokeWidth="0.8"
        android:strokeColor="#33FFFFFF" />
    <path
        android:fillColor="#00000000"
        android:pathData="M0,9L108,9"
        android:strokeWidth="0.8"
        android:strokeColor="#33FFFFFF" />
    <path
        android:fillColor="#00000000"
        android:pathData="M0,19L108,19"
        android:strokeWidth="0.8"
        android:strokeColor="#33FFFFFF" />
    <path
        android:fillColor="#00000000"
        android:pathData="M0,29L108,29"
        android:strokeWidth="0.8"
        android:strokeColor="#33FFFFFF" />
    <path
        android:fillColor="#00000000"
        android:pathData="M0,39L108,39"
        android:strokeWidth="0.8"
        android:strokeColor="#33FFFFFF" />
    <path
        android:fillColor="#00000000"
        android:pathData="M0,49L108,49"
        android:strokeWidth="0.8"
        android:strokeColor="#33FFFFFF" />
    <path
        android:fillColor="#00000000"
        android:pathData="M0,59L108,59"
        android:strokeWidth="0.8"
        android:strokeColor="#33FFFFFF" />
    <path
        android:fillColor="#00000000"
        android:pathData="M0,69L108,69"
        android:strokeWidth="0.8"
        android:strokeColor="#33FFFFFF" />
    <path
        android:fillColor="#00000000"
        android:pathData="M0,79L108,79"
        android:strokeWidth="0.8"
        android:strokeColor="#33FFFFFF" />
    <path
        android:fillColor="#00000000"
        android:pathData="M0,89L108,89"
        android:strokeWidth="0.8"
        android:strokeColor="#33FFFFFF" />
    <path
        android:fillColor="#00000000"
        android:pathData="M0,99L108,99"
        android:strokeWidth="0.8"
        android:strokeColor="#33FFFFFF" />
    <path
        android:fillColor="#00000000"
        android:pathData="M19,29L89,29"
        android:strokeWidth="0.8"
        android:strokeColor="#33FFFFFF" />
    <path
        android:fillColor="#00000000"
        android:pathData="M19,39L89,39"
        android:strokeWidth="0.8"
        android:strokeColor="#33FFFFFF" />
    <path
        android:fillColor="#00000000"
        android:pathData="M19,49L89,49"
        android:strokeWidth="0.8"
        android:strokeColor="#33FFFFFF" />
    <path
        android:fillColor="#00000000"
        android:pathData="M19,59L89,59"
        android:strokeWidth="0.8"
        android:strokeColor="#33FFFFFF" />
    <path
        android:fillColor="#00000000"
        android:pathData="M19,69L89,69"
        android:strokeWidth="0.8"
        android:strokeColor="#33FFFFFF" />
    <path
        android:fillColor="#00000000"
        android:pathData="M19,79L89,79"
        android:strokeWidth="0.8"
        android:strokeColor="#33FFFFFF" />
    <path
        android:fillColor="#00000000"
        android:pathData="M29,19L29,89"
        android:strokeWidth="0.8"
        android:strokeColor="#33FFFFFF" />
    <path
        android:fillColor="#00000000"
        android:pathData="M39,19L39,89"
        android:strokeWidth="0.8"
        android:strokeColor="#33FFFFFF" />
    <path
        android:fillColor="#00000000"
        android:pathData="M49,19L49,89"
        android:strokeWidth="0.8"
        android:strokeColor="#33FFFFFF" />
    <path
        android:fillColor="#00000000"
        android:pathData="M59,19L59,89"
        android:strokeWidth="0.8"
        android:strokeColor="#33FFFFFF" />
    <path
        android:fillColor="#00000000"
        android:pathData="M69,19L69,89"
        android:strokeWidth="0.8"
        android:strokeColor="#33FFFFFF" />
    <path
        android:fillColor="#00000000"
        android:pathData="M79,19L79,89"
        android:strokeWidth="0.8"
        android:strokeColor="#33FFFFFF" />
</vector>
```
--- END OF FILE: app\src\main\res\drawable\ic_launcher_background.xml ---

--- START OF FILE: app\src\main\res\drawable\ic_launcher_foreground.xml ---
```xml
<vector xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:aapt="http://schemas.android.com/aapt"
    android:width="108dp"
    android:height="108dp"
    android:viewportWidth="108"
    android:viewportHeight="108">
    <path android:pathData="M31,63.928c0,0 6.4,-11 12.1,-13.1c7.2,-2.6 26,-1.4 26,-1.4l38.1,38.1L107,108.928l-32,-1L31,63.928z">
        <aapt:attr name="android:fillColor">
            <gradient
                android:endX="85.84757"
                android:endY="92.4963"
                android:startX="42.9492"
                android:startY="49.59793"
                android:type="linear">
                <item
                    android:color="#44000000"
                    android:offset="0.0" />
                <item
                    android:color="#00000000"
                    android:offset="1.0" />
            </gradient>
        </aapt:attr>
    </path>
    <path
        android:fillColor="#FFFFFF"
        android:fillType="nonZero"
        android:pathData="M65.3,45.828l3.8,-6.6c0.2,-0.4 0.1,-0.9 -0.3,-1.1c-0.4,-0.2 -0.9,-0.1 -1.1,0.3l-3.9,6.7c-6.3,-2.8 -13.4,-2.8 -19.7,0l-3.9,-6.7c-0.2,-0.4 -0.7,-0.5 -1.1,-0.3C38.8,38.328 38.7,38.828 38.9,39.228l3.8,6.6C36.2,49.428 31.7,56.028 31,63.928h46C76.3,56.028 71.8,49.428 65.3,45.828zM43.4,57.328c-0.8,0 -1.5,-0.5 -1.8,-1.2c-0.3,-0.7 -0.1,-1.5 0.4,-2.1c0.5,-0.5 1.4,-0.7 2.1,-0.4c0.7,0.3 1.2,1 1.2,1.8C45.3,56.528 44.5,57.328 43.4,57.328L43.4,57.328zM64.6,57.328c-0.8,0 -1.5,-0.5 -1.8,-1.2s-0.1,-1.5 0.4,-2.1c0.5,-0.5 1.4,-0.7 2.1,-0.4c0.7,0.3 1.2,1 1.2,1.8C66.5,56.528 65.6,57.328 64.6,57.328L64.6,57.328z"
        android:strokeWidth="1"
        android:strokeColor="#00000000" />
</vector>
```
--- END OF FILE: app\src\main\res\drawable\ic_launcher_foreground.xml ---

--- START OF FILE: app\src\main\res\layout\activity_main.xml ---
```xml
<?xml version="1.0" encoding="utf-8"?>
<androidx.coordinatorlayout.widget.CoordinatorLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:app="http://schemas.android.com/apk/res-auto"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:fitsSystemWindows="true"
    tools:context=".MainActivity">

    <com.google.android.material.appbar.AppBarLayout
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:fitsSystemWindows="true">

        <com.google.android.material.appbar.MaterialToolbar
            android:id="@+id/toolbar"
            android:layout_width="match_parent"
            android:layout_height="?attr/actionBarSize" />

    </com.google.android.material.appbar.AppBarLayout>

    <include layout="@layout/content_main" />

<!--    <com.google.android.material.floatingactionbutton.FloatingActionButton-->
<!--        android:id="@+id/fab"-->
<!--        android:layout_width="wrap_content"-->
<!--        android:layout_height="wrap_content"-->
<!--        android:layout_gravity="bottom|end"-->
<!--        android:layout_marginEnd="@dimen/fab_margin"-->
<!--        android:layout_marginBottom="16dp"-->
<!--        app:srcCompat="@android:drawable/ic_dialog_email" />-->

</androidx.coordinatorlayout.widget.CoordinatorLayout>
```
--- END OF FILE: app\src\main\res\layout\activity_main.xml ---

--- START OF FILE: app\src\main\res\layout\content_main.xml ---
```xml
<?xml version="1.0" encoding="utf-8"?>
<androidx.constraintlayout.widget.ConstraintLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:app="http://schemas.android.com/apk/res-auto"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    app:layout_behavior="@string/appbar_scrolling_view_behavior">

    <fragment
        android:id="@+id/nav_host_fragment_content_main"
        android:name="androidx.navigation.fragment.NavHostFragment"
        android:layout_width="0dp"
        android:layout_height="0dp"
        app:defaultNavHost="true"
        app:layout_constraintBottom_toBottomOf="parent"
        app:layout_constraintEnd_toEndOf="parent"
        app:layout_constraintStart_toStartOf="parent"
        app:layout_constraintTop_toTopOf="parent"
        app:navGraph="@navigation/nav_graph" />
</androidx.constraintlayout.widget.ConstraintLayout>
```
--- END OF FILE: app\src\main\res\layout\content_main.xml ---

--- START OF FILE: app\src\main\res\layout\fragment_first.xml ---
```xml
<?xml version="1.0" encoding="utf-8"?>
<androidx.core.widget.NestedScrollView xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:app="http://schemas.android.com/apk/res-auto"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    tools:context=".FirstFragment">

    <androidx.constraintlayout.widget.ConstraintLayout
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:padding="30dp">

        <EditText
            android:id="@+id/socks5"
            android:layout_width="match_parent"
            android:layout_height="match_parent"
            android:layout_marginTop="16dp"
            android:layout_marginBottom="16dp"
            android:autofillHints="0.0.0.0:1055"
            android:ems="10"
            android:inputType="text"
            android:text="Socks5"
            app:layout_constraintBottom_toTopOf="@+id/sshserver"
            app:layout_constraintTop_toTopOf="parent"
            app:layout_constraintEnd_toEndOf="parent"
            app:layout_constraintStart_toStartOf="parent"
            app:layout_constraintVertical_bias="0.0"
            tools:layout_editor_absoluteX="65dp" />

        <EditText
            android:id="@+id/sshserver"
            android:layout_width="match_parent"
            android:layout_height="match_parent"
            android:layout_marginTop="16dp"
            android:layout_marginBottom="16dp"
            android:autofillHints="0.0.0.0:1056"
            android:ems="10"
            android:inputType="text"
            android:text="SSH"
            app:layout_constraintTop_toBottomOf="@+id/socks5"
            app:layout_constraintBottom_toTopOf="@+id/authkey"
            app:layout_constraintEnd_toEndOf="parent"
            app:layout_constraintStart_toStartOf="parent"
            tools:layout_editor_absoluteX="81dp"
            tools:layout_editor_absoluteY="61dp" />

        <EditText
            android:id="@+id/authkey"
            android:layout_width="match_parent"
            android:layout_height="match_parent"
            android:layout_marginTop="16dp"
            android:layout_marginBottom="16dp"
            android:autofillHints="tskey-xxxx"
            android:ems="10"
            android:inputType="text"
            android:text="AuthKey"
            app:layout_constraintTop_toBottomOf="@+id/sshserver"
            app:layout_constraintBottom_toTopOf="@+id/button_first"
            app:layout_constraintEnd_toEndOf="parent"
            app:layout_constraintStart_toStartOf="parent"
            tools:layout_editor_absoluteX="81dp"
            tools:layout_editor_absoluteY="61dp" />
<!--        <TextView-->
<!--            android:id="@+id/textview_first"-->
<!--            android:layout_width="match_parent"-->
<!--            android:layout_height="match_parent"-->
<!--            android:layout_marginTop="16dp"-->
<!--            android:layout_marginBottom="16dp"-->
<!--            android:text="@string/lorem_ipsum"-->
<!--            app:layout_constraintBottom_toTopOf="@+id/button_first"-->
<!--            app:layout_constraintTop_toBottomOf="@+id/sshserver"-->
<!--            app:layout_constraintEnd_toEndOf="parent"-->
<!--            app:layout_constraintHorizontal_bias="0.497"-->
<!--            app:layout_constraintStart_toStartOf="parent"-->
<!--            app:layout_constraintVertical_bias="0.25" />-->

        <Button
            android:id="@+id/button_first"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_marginTop="16dp"
            android:layout_marginBottom="16dp"
            android:text="@string/next"
            app:layout_constraintBottom_toBottomOf="parent"
            app:layout_constraintEnd_toEndOf="parent"
            app:layout_constraintHorizontal_bias="0.498"
            app:layout_constraintStart_toStartOf="parent"
            app:layout_constraintTop_toBottomOf="@+id/sshserver"
            app:layout_constraintVertical_bias="1.0" />


    </androidx.constraintlayout.widget.ConstraintLayout>
</androidx.core.widget.NestedScrollView>
```
--- END OF FILE: app\src\main\res\layout\fragment_first.xml ---

--- START OF FILE: app\src\main\res\mipmap-anydpi-v26\ic_launcher.xml ---
```xml
<?xml version="1.0" encoding="utf-8"?>
<adaptive-icon xmlns:android="http://schemas.android.com/apk/res/android">
    <background android:drawable="@drawable/ic_launcher_background" />
    <foreground android:drawable="@drawable/ic_launcher_foreground" />
    <monochrome android:drawable="@drawable/ic_launcher_foreground" />
</adaptive-icon>
```
--- END OF FILE: app\src\main\res\mipmap-anydpi-v26\ic_launcher.xml ---

--- START OF FILE: app\src\main\res\mipmap-anydpi-v26\ic_launcher_round.xml ---
```xml
<?xml version="1.0" encoding="utf-8"?>
<adaptive-icon xmlns:android="http://schemas.android.com/apk/res/android">
    <background android:drawable="@drawable/ic_launcher_background" />
    <foreground android:drawable="@drawable/ic_launcher_foreground" />
    <monochrome android:drawable="@drawable/ic_launcher_foreground" />
</adaptive-icon>
```
--- END OF FILE: app\src\main\res\mipmap-anydpi-v26\ic_launcher_round.xml ---

--- START OF FILE: app\src\main\res\navigation\nav_graph.xml ---
```xml
<?xml version="1.0" encoding="utf-8"?>
<navigation xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:app="http://schemas.android.com/apk/res-auto"
    xmlns:tools="http://schemas.android.com/tools"
    android:id="@+id/nav_graph"
    app:startDestination="@id/FirstFragment">

    <fragment
        android:id="@+id/FirstFragment"
        android:name="io.github.asutorufa.tailscaled.FirstFragment"
        android:label="@string/first_fragment_label"
        tools:layout="@layout/fragment_first">
    </fragment>

</navigation>
```
--- END OF FILE: app\src\main\res\navigation\nav_graph.xml ---

--- START OF FILE: app\src\main\res\values\colors.xml ---
```xml
<?xml version="1.0" encoding="utf-8"?>
<resources>
    <color name="black">#FF000000</color>
    <color name="white">#FFFFFFFF</color>
</resources>
```
--- END OF FILE: app\src\main\res\values\colors.xml ---

--- START OF FILE: app\src\main\res\values\dimens.xml ---
```xml
<resources>
    <dimen name="fab_margin">16dp</dimen>
</resources>
```
--- END OF FILE: app\src\main\res\values\dimens.xml ---

--- START OF FILE: app\src\main\res\values\strings.xml ---
```xml
<resources>
    <string name="app_name">Tailscaled</string>
    <string name="action_settings">Settings</string>
    <string name="first_fragment_label">Tailscaled</string>
    <string name="next">Start</string>

    <string name="lorem_ipsum">
        ssh: 127.0.0.1:1056\n
        socks5: 127.0.0.1:1055
    </string>
</resources>
```
--- END OF FILE: app\src\main\res\values\strings.xml ---

--- START OF FILE: app\src\main\res\values\themes.xml ---
```xml
<resources xmlns:tools="http://schemas.android.com/tools">
    <!-- Base application theme. -->
    <style name="Base.Theme.Tailscaled" parent="Theme.Material3.DayNight.NoActionBar">
        <!-- Customize your light theme here. -->
        <!-- <item name="colorPrimary">@color/my_light_primary</item> -->
    </style>

    <style name="Theme.Tailscaled" parent="Base.Theme.Tailscaled" />
</resources>
```
--- END OF FILE: app\src\main\res\values\themes.xml ---

--- START OF FILE: app\src\main\res\values-land\dimens.xml ---
```xml
<resources>
    <dimen name="fab_margin">48dp</dimen>
</resources>
```
--- END OF FILE: app\src\main\res\values-land\dimens.xml ---

--- START OF FILE: app\src\main\res\values-night\themes.xml ---
```xml
<resources xmlns:tools="http://schemas.android.com/tools">
    <!-- Base application theme. -->
    <style name="Base.Theme.Tailscaled" parent="Theme.Material3.DayNight.NoActionBar">
        <!-- Customize your dark theme here. -->
        <!-- <item name="colorPrimary">@color/my_dark_primary</item> -->
    </style>
</resources>
```
--- END OF FILE: app\src\main\res\values-night\themes.xml ---

--- START OF FILE: app\src\main\res\values-v23\themes.xml ---
```xml
<resources xmlns:tools="http://schemas.android.com/tools">

    <style name="Theme.Tailscaled" parent="Base.Theme.Tailscaled">
        <!-- Transparent system bars for edge-to-edge. -->
        <item name="android:navigationBarColor">@android:color/transparent</item>
        <item name="android:statusBarColor">@android:color/transparent</item>
        <item name="android:windowLightStatusBar">?attr/isLightTheme</item>
    </style>
</resources>
```
--- END OF FILE: app\src\main\res\values-v23\themes.xml ---

--- START OF FILE: app\src\main\res\values-w1240dp\dimens.xml ---
```xml
<resources>
    <dimen name="fab_margin">200dp</dimen>
</resources>
```
--- END OF FILE: app\src\main\res\values-w1240dp\dimens.xml ---

--- START OF FILE: app\src\main\res\values-w600dp\dimens.xml ---
```xml
<resources>
    <dimen name="fab_margin">48dp</dimen>
</resources>
```
--- END OF FILE: app\src\main\res\values-w600dp\dimens.xml ---

--- START OF FILE: app\src\main\res\xml\backup_rules.xml ---
```xml
<?xml version="1.0" encoding="utf-8"?><!--
   Sample backup rules file; uncomment and customize as necessary.
   See https://developer.android.com/guide/topics/data/autobackup
   for details.
   Note: This file is ignored for devices older that API 31
   See https://developer.android.com/about/versions/12/backup-restore
-->
<full-backup-content>
    <!--
   <include domain="sharedpref" path="."/>
   <exclude domain="sharedpref" path="device.xml"/>
-->
</full-backup-content>
```
--- END OF FILE: app\src\main\res\xml\backup_rules.xml ---

--- START OF FILE: app\src\main\res\xml\data_extraction_rules.xml ---
```xml
<?xml version="1.0" encoding="utf-8"?><!--
   Sample data extraction rules file; uncomment and customize as necessary.
   See https://developer.android.com/about/versions/12/backup-restore#xml-changes
   for details.
-->
<data-extraction-rules>
    <cloud-backup>
        <!-- TODO: Use <include> and <exclude> to control what is backed up.
        <include .../>
        <exclude .../>
        -->
    </cloud-backup>
    <!--
    <device-transfer>
        <include .../>
        <exclude .../>
    </device-transfer>
    -->
</data-extraction-rules>
```
--- END OF FILE: app\src\main\res\xml\data_extraction_rules.xml ---

--- START OF FILE: appctr\build.sh ---
```sh
#export ANDROID_HOME="${HOME}/.local/storage/Android/Sdk/"
#export ANDROID_NDK_HOME="${HOME}/.local/storage/Android/android-ndk-r23c"
#export PATH=$PATH:"${HOME}/.local/share/JetBrains/Toolbox/apps/android-studio/jbr/bin"


gomobile bind -ldflags='-s -w -buildid=' -trimpath -target="android/arm64,android/amd64" -androidapi 21 -o appctr.aar -v .
```
--- END OF FILE: appctr\build.sh ---

--- START OF FILE: build.sh ---
```sh
#!/bin/bash

JAVA_BIN=

JAVA_BIN="${HOME}/.local/share/JetBrains/Toolbox/apps/android-studio/jbr/bin"

#for file in "${HOME}"/.local/share/JetBrains/Toolbox/apps/AndroidStudio/ch-0/*
#do
#  if [ -f "${file}/jbr/bin/javac" ]; then
#    JAVA_BIN="${file}/jbr/bin"
#    break
#   fi
#done

if [ "${JAVA_BIN}" = "" ]; then
  echo "can't find java bin"
  exit 1
fi

PATH=$PATH:${JAVA_BIN} KEYSTORE_PATH=/home/asutorufa/Documents/Programming/asutorufa.keystore KEY_ALIAS=key0 KEYSTORE_PASSWORD=asutorufa KEY_PASSWORD=asutorufa ./gradlew app:assembleRelease --stacktrace
```
--- END OF FILE: build.sh ---

--- START OF FILE: readme.md ---
```md
#

## use auth key

- generate auth key at tailscale web [Settings -> Personal Settings -> Keys -> Auth Keys -> Generate auth key…]
- copy the key and enter it at auth key
- then click start
- check device appear at tailscale web [Machines]
```
--- END OF FILE: readme.md ---
